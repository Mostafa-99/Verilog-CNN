`timescale 1ns / 1ps
module avg_layer_tb ;
parameter EXPONENT_WIDTH = 5;
parameter MANTISSA_WIDTH = 10;
parameter dimension = 28 ;
parameter dimension2 = (dimension/2)  ;
parameter DATA_WIDTH = EXPONENT_WIDTH+MANTISSA_WIDTH+1;
reg [(dimension*dimension*DATA_WIDTH)-1:0] input_value;
reg reset ;
reg clk;
wire [(dimension2*dimension2*DATA_WIDTH)-1:0] output_value;

initial
begin
clk =1;
reset = 0;
input_value = 12544'h3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00_3C0040004200440045004600470048004880490049804A004A804B004B804C004C404C804CC04D004D404D804DC04E004E404E804EC04F00;



/*
//this 10x10 matrix test cases if you want to run them uncomment them and make the dimension parameter=10 and comment 28*28 test cases
input_value = 1600'h3C00_3C00_3C00_3C00_3C00_3C00_3C00_3C00_3C00_3C00_400040004000400040004000400040004000400042004200420042004200420042004200420042004400440044004400440044004400440044004400450045004500450045004500450045004500450046004600460046004600460046004600460046004700470047004700470047004700470047004700480048004800480048004800480048004800480048804880488048804880488048804880488048804900490049004900490049004900490049004900;

// 10x10 matrix
//[1 1 1 1 1 1 1 1 1 1]
//[2 2 2 2 2 2 2 2 2 2]
//[3 3 3 3 3 3 3 3 3 3]                        // 5x5 matrix
//[4 4 4 4 4 4 4 4 4 4]                      [1.5 1.5 1.5 1.5 1.5]  
//[5 5 5 5 5 5 5 5 5 5]                     [3.5 3.5 3.5 3.5 3.5] 
//[6 6 6 6 6 6 6 6 6 6]            ->      [5.5 5.5 5.5 5.5 5.5]
//[7 7 7 7 7 7 7 7 7 7]                   [7.5 7.5 7.5 7.5 7.5]
//[8 8 8 8 8 8 8 8 8 8]                  [9.5 9.5 9.5 9.5 9.5]
//[9 9 9 9 9 9 9 9 9 9]
//[10 10 10 10 10 10 10 10 10 10]

#8 reset = 1 ;
#2 reset = 0 ;
input_value = 1600'h3C00400042004400450046004700480048804900_3C00400042004400450046004700480048804900_3C00400042004400450046004700480048804900_3C00400042004400450046004700480048804900_3C00400042004400450046004700480048804900_3C00400042004400450046004700480048804900_3C00400042004400450046004700480048804900_3C00400042004400450046004700480048804900_3C00400042004400450046004700480048804900_3C00400042004400450046004700480048804900_3C00400042004400450046004700480048804900;


#8 reset = 1 ;
#2 reset = 0 ;
input_value = 1600'h3C003C003C003C003C003C003C003C003C003C003C003C003C003C003C003C003C003C003C003C00_42663E00BC66474D49004E6D450041004780C000_2E66B8CD399AC39A4F6046E652405A0234003266_6400C0004800460045C00000440058B042CD4500_5640C900CA80524047C00000400047E645E64600_2E66326634CD3666380038CD399A3A663B333C00_211F251F27AE291F2A662BAE2C7B2D1F2DC32E66_2E66326634CD3666380038CD399A3A663B333C00_2E66326634CD3666380038CD399A3A663B333C00 ;
// 10x10 matrix
//[1      1    1     1     1     1      1     1       1         1]
//[1     1     1     1     1     1      1     1      1         1]                           [1           1          1          1          1]
//[3.2  1.5  -1.1   7.3   10    25.7    5    2.5    7.5      -2]                            [1.05      0.775      18.025      62.44     1.487] 
//[0.1 -0.6  0.7   -3.8  29.5   6.9    50   192.3  0.25     0.2]         --->               [278       12.75      3.375       40.97        5.074]                                                                               //[] 
//[1024 -2   8      6    5.75   0      4    150     3.4      5]                             [0.0825   0.1925      0.3025      0.4125     0.5525]
//[100 -10  -13     50   7.75   0      2    7.9     5.9      6]                             [0.15     0.25         0.35        0.55        0.95 ]
//[0.1 0.2  0.3     0.4   0.5    0.6     0.7   0.8      0.9      1]
//[0.01 0.02  0.03  0.04  0.05   0.06   0.07   0.08    0.09    0.1]
//[0.1  0.2   0.3   0.4   0.5    0.6    0.7    0.8      0.9     1]
//[0.1  0.2   0.3    0.4  0.5    0.6    0.7   0.9     0.9      1]

*/


#25 $stop;
end
always begin
     #1  clk = ~clk; 
    end

avg_layer #(.EXPONENT_WIDTH(EXPONENT_WIDTH), .MANTISSA_WIDTH(MANTISSA_WIDTH), .dimension(dimension),
.DATA_WIDTH(DATA_WIDTH)) inst1 (
.img_in(input_value),
.clk(clk),
.img_out(output_value),
.reset(reset)
);
endmodule





//input_value = 512'b01000000000000000000000000000000010000000100000000000000000000000011111110000000000000000000000001000000000000000000000000000000010000001000000000000000000000000100000010100000000000000000000001000000010000000000000000000000010000001000000000000000000000001011111110000000000000000000000011000000000000000000000000000000110000000000000000000000000000001100000001000000000000000000000011000000010000000000000000000000110000001000000000000000000000001100000010000000000000000000000011000000101000000000000000000000 ;

//[2  3  1  2]
//[4  5  3  4]
//[-1 -2 -2 -3] 
//[-3 -4 -4 -5]

//[13 -5 -8  2]
//[100 1250 10 1]`
//[4 5 6 7]   -->  [7.75   11]
//[10 12 15 16]     -->[339.5    1.25]
//input_value = 512'b01000001010100000000000000000000110000001010000000000000000000001100000100000000000000000000000001000000000000000000000000000000010000101100100000000000000000000100010010011100010000000000000001000001001000000000000000000000001111111000000000000000000000000100000100100000000000000000000001000001010000000000000000000000010000010111000000000000000000000100000110000000000000000000000001000000100000000000000000000000010000001010000000000000000000000100000011000000000000000000000001000000111000000000000000000000;
